# HOPEminiBOT Design Principles

<!-- AI SIGNATURE: Created by Claude (opus-4) at 2026-01-29 12:00:00 UTC -->

> "Мы строим лайнер, а не фейерверк. Выживаемость — базовая метрика."

## Mission Statement

HOPEminiBOT — не про "проценты любой ценой". Это про выживаемость: аудит, fail-closed, прозрачные данные и строгий риск-контроль.

Амбиции должны работать на результат, а не на эффект. "Максимум в неделю" звучит ярко, но чаще всего это вспышка риска, а не стратегия.

---

## Priority Matrix (P0-P3)

| Priority | Principle | Description |
|----------|-----------|-------------|
| **P0** | Сохранение капитала | Прирост выше средних показателей рынка. Капитал — основа всего. |
| **P1** | Ограничение просадки | Максимальная просадка должна быть контролируемой и предсказуемой. |
| **P2** | Наращивание статистики | Больше данных = лучше решения. Каждая сделка — источник информации. |
| **P3** | Улучшение мат. ожидания | Постепенная оптимизация на основе доказуемых результатов. |

### Priority Invariants

- P0 нарушение → немедленная остановка торговли
- P1 нарушение → снижение размера позиции
- P2, P3 — оптимизационные цели, не жёсткие ограничения

---

## Architectural Discipline

### Fail-Closed Principle

При сомнении система выбирает безопасность, а не "попробовать".

```
Сомнение в данных     → FAIL (не "пропустить")
Отсутствие зависимости → FAIL (не "потом")
Неясное требование    → ASK  (один вопрос)
Частичный результат   → FAIL (не "почти готово")
```

### Core Invariants

| Invariant | Description |
|-----------|-------------|
| **Воспроизводимость > обещания** | Любой результат должен быть воспроизводим. Нет магии. |
| **Доказуемая корректность > "попробовать"** | Код работает потому что доказано, не потому что "вроде работает". |
| **Прозрачные контракты данных** | Каждый компонент имеет явный контракт входа/выхода. |
| **Наблюдаемость** | Состояние системы видно в любой момент. |

---

## Mode Transition Protocol

```
┌─────────┐    критерии    ┌──────────┐    критерии    ┌────────┐
│   DRY   │ ─────────────► │  TESTNET │ ─────────────► │  LIVE  │
└─────────┘                └──────────┘                └────────┘
     │                          │                          │
     └──── НЕ по настроению ────┴──── НЕ по настроению ────┘
```

### DRY → TESTNET Criteria

- [ ] Все unit-тесты проходят
- [ ] Smoke gate PASS
- [ ] Логика сигналов стабильна (нет изменений 48h)
- [ ] Контракты данных заморожены

### TESTNET → LIVE Criteria

- [ ] 100+ сделок на TESTNET без критических ошибок
- [ ] Просадка в пределах P1 лимита
- [ ] Положительное мат. ожидание на выборке
- [ ] Risk Governor настроен и протестирован
- [ ] Secrets в защищённом хранилище
- [ ] Monitoring и alerting настроены

---

## Anti-Patterns (Forbidden)

### Запрещённые подходы

| Anti-Pattern | Why Forbidden |
|--------------|---------------|
| "Попробуем и посмотрим" | Нет доказуемости, риск потери капитала |
| "Максимум за неделю" | Вспышка риска, не стратегия |
| Обещания доходности | Невоспроизводимы, создают ложные ожидания |
| Silent failures | Скрывают проблемы до катастрофы |
| Магическое мышление | "Должно работать" без доказательств |

### Запрещённые утверждения в коде/документации

```
❌ "Доходность 15-150% в месяц"
❌ "Гарантированный результат"
❌ "Безрисковая стратегия"
❌ "Работает в любых условиях"

✓ "Цель: прирост выше benchmark при контролируемом риске"
✓ "Тестовые результаты: X% за период Y при просадке Z%"
✓ "Требует валидации на реальных данных"
```

---

## Quality Gates

### Pre-Trade Gate

```python
def pre_trade_gate(signal: Signal) -> bool:
    """P0-P1 checks before any trade."""
    if portfolio.drawdown > MAX_DRAWDOWN:
        return False  # P1 violation
    if not signal.has_valid_snapshot():
        return False  # Data integrity
    if signal.risk_reward < MIN_RR:
        return False  # P3 optimization
    return True
```

### Post-Trade Audit

Каждая сделка записывается с:
- entry_price, exit_price
- MFE (Maximum Favorable Excursion)
- MAE (Maximum Adverse Excursion)
- signal_id (sha256 трейсинг)
- режим (DRY/TESTNET/LIVE)

---

## Metrics That Matter

| Metric | Target | Hard Limit |
|--------|--------|------------|
| Max Drawdown | < 10% | 20% (stop trading) |
| Win Rate | > 50% | N/A (informational) |
| Risk/Reward | > 1.5 | 1.0 minimum |
| Sharpe Ratio | > 1.0 | N/A (optimization) |
| Recovery Factor | > 2.0 | N/A (optimization) |

---

## Summary

**HOPEminiBOT строится как система с дисциплиной:**

1. **Логика** — каждое решение обосновано
2. **Архитектура** — чистая, наблюдаемая, тестируемая
3. **Внимание к деталям** — fail-closed, контракты, аудит

**Фундамент цели:** сохранение капитала, ограничение просадки, наращивание статистики, улучшение мат. ожидания.

**Переход режимов:** только по критериям, не по настроению.

**Метафора:** Лайнер, который выдерживает штормы рынка и продолжает идти по маршруту.

---

*Документ является SSoT для принципов проектирования HOPEminiBOT.*
*Изменения требуют явного согласования с владельцем проекта.*
